<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Study Sprint Tracker</title>
    <!-- <link rel="stylesheet" href="style3.css"/> -->
    <!-- <link rel="stylesheet" href="rn.css"/> -->
    <style>
      /* ==================================================================
 /* ==================================================================
   [Section 01] → Import Google Fonts 
   Fonts: Inter (Body), Orbitron (Headings), Poppins (Optional fallback)
   ================================================================== */
      @import url("https://fonts.googleapis.com/css2?family=Inter&family=Orbitron:wght@600&family=Poppins:wght@500&display=swap");
      /* ================================================================== */

      /* ==================================================================
   [Section 02] → Base Reset Styles
   ================================================================== */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      /* Smooth scroll behavior */
      html {
        scroll-behavior: smooth;
      }

      /* Body Styling: Dark Theme + Center Layout */
      body {
        background-color: #121212;
        /* Optional grid texture — comment/uncomment below */
        /* background-image: radial-gradient(circle, rgba(255,255,255,0.03) 1px, transparent 1px);
     background-size: 30px 30px; */
        font-family: "Inter", sans-serif;
        color: #ffffff;
        min-height: 100vh;
        padding: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow-x: hidden;
        position: relative;
        z-index: 0;
      }
      /* ================================================================== */

      /* ================================================================== */

      /* ==================================================================
  /* ==================================================================
   [Section 03] → Scrollbar Styles
   Purpose: Neon-themed custom scroll for better UX
   ================================================================== */

      /* Width of the scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
      }

      /* Track area */
      ::-webkit-scrollbar-track {
        background: #1e1e1e;
        box-shadow: inset 0 0 4px rgba(0, 255, 255, 0.1);
      }

      /* Scroll thumb (draggable part) */
      ::-webkit-scrollbar-thumb {
        background: #00ffff;
        border-radius: 10px;
        transition: background 0.3s ease;
      }

      /* On hover effect */
      ::-webkit-scrollbar-thumb:hover {
        background: #00ffffcc;
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 4] → Animations
   ================================================================== */
      @keyframes fadeIn {
        0% {
          opacity: 0;
          transform: scale(0.95);
        }
        100% {
          opacity: 1;
          transform: scale(1);
        }
      }
      @keyframes pulseGlow {
        0% {
          box-shadow: 0 0 5px #00ffff;
        }
        50% {
          box-shadow: 0 0 15px #00ffff;
        }
        100% {
          box-shadow: 0 0 5px #00ffff;
        }
      }
      @keyframes blinkPause {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }
      @keyframes pulseRunning {
        0% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.6;
          transform: scale(1.05);
        }
        100% {
          opacity: 1;
          transform: scale(1);
        }
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 5] → Fullscreen Toggle Button
   ================================================================== */
      #fullscreen-btn {
        position: fixed;
        top: 20px;
        right: 20px;
        background-color: #00bcd4;
        color: #fff;
        padding: 10px 15px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        z-index: 1001;
        box-shadow: 0 0 8px #00ffff;
        transition: opacity 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
      }
      #fullscreen-btn:hover {
        background-color: #00ffff;
        color: #121212;
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 0 12px #00ffff, 0 0 24px #00ffff;
      }
      #fullscreen-btn.hidden {
        opacity: 0;
        pointer-events: none;
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 6] → Fullscreen Overlay
   ================================================================== */
      #fullscreen-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        height: 100vh;
        width: 100vw;
        background-color: #121212;
        z-index: 999;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        color: #00ffff;
        text-align: center;
        animation: fadeIn 0.6s ease-in-out;
      }
      #fullscreen-overlay.show {
        display: flex;
      }
      #fullscreen-overlay h1 {
        font-size: 3rem;
        margin-bottom: 20px;
        font-family: "Orbitron", sans-serif;
      }
      #fullscreen-timer {
        font-size: 4rem;
        font-weight: bold;
        letter-spacing: 2px;
      }
      /* ================================================================== */

      /* ==================================================================
  /* ==================================================================
   [Section 07] → Fullscreen Title & Timer Styling
   Purpose: Clean, glowing central title and timer for fullscreen mode
   ================================================================== */

      #fullscreen-title {
        color: #00ffff;
        font-size: 2.5rem;
        margin-bottom: 1.2rem;
        font-family: "Orbitron", sans-serif;
        font-weight: 700;
        letter-spacing: 1.2px;
        text-shadow: 0 0 12px #00ffff, 0 0 24px #00ffff33;
      }

      #fullscreen-timer {
        color: #ffffff;
        font-size: 3.8rem;
        font-weight: 800;
        letter-spacing: 2.5px;
        text-shadow: 0 0 15px #ffffff, 0 0 25px #ffffff55;
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 08] → Fullscreen Controls
   Purpose: Floating pause/resume buttons with neon-glow effect
   ================================================================== */

      #fullscreen-controls {
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 1002;
        display: flex;
        gap: 12px;
        transition: opacity 0.3s ease;
      }

      #fullscreen-controls.hidden {
        opacity: 0;
        pointer-events: none;
      }

      #fullscreen-controls button {
        padding: 10px 16px;
        font-size: 1rem;
        font-weight: 600;
        border: none;
        border-radius: 8px;
        background-color: rgba(0, 188, 212, 0.9);
        color: #ffffff;
        cursor: pointer;
        box-shadow: 0 0 12px #00ffff99, 0 0 20px rgba(0, 255, 255, 0.2);
        transition: all 0.3s ease;
        backdrop-filter: blur(4px);
        text-shadow: 0 0 6px #00ffffaa;
      }

      #fullscreen-controls button:hover {
        background-color: #00ffff;
        color: #121212;
        transform: scale(1.05);
        box-shadow: 0 0 18px #00ffff, 0 0 36px #00ffff66;
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 09] → Pause Message
   Purpose: Blinking neon-red alert when paused (center stage)
   ================================================================== */

      #pause-message {
        font-size: 3rem;
        color: #ff4d4d;
        margin-bottom: 24px;
        text-align: center;
        display: none;
        animation: blinkPause 1.2s infinite ease-in-out;
        font-weight: 800;
        letter-spacing: 2px;
        text-shadow: 0 0 6px #ff4d4d, 0 0 12px #ff4d4d, 0 0 24px #ff0000,
          0 0 40px #ff1a1a, 0 0 60px #ff1a1a;
        user-select: none;
        max-width: 90vw;
        margin-left: auto;
        margin-right: auto;
      }

      /* 📱 Mobile-Friendly Adjustments */
      @media (max-width: 480px) {
        #pause-message {
          font-size: 1.4rem;
          margin-bottom: 15px;
          padding: 0;
        }
      }

      /* ================================================================== */

      /* ==================================================================
   [Section 10] → Container Styles
   Purpose: Central content box with glassmorphic neon glow effect
   ================================================================== */

      .container {
        width: 100%;
        max-width: 960px; /* Responsive container width */
        margin: 0 auto;
        background-color: rgba(30, 30, 30, 0.75);
        backdrop-filter: blur(14px);
        padding: 32px;
        border-radius: 18px;

        /* Outer Glow + Inner Edge */
        box-shadow: 0 0 20px rgba(0, 255, 255, 0.15),
          inset 0 0 4px rgba(0, 255, 255, 0.2);

        border: 1px solid rgba(0, 255, 255, 0.25);
        animation: fadeIn 0.6s ease-in-out;

        position: relative;
        z-index: 1;
      }

      @media (max-width: 480px) {
        .container {
          padding: 20px;
        }
      }

      /* ================================================================== */

      /* ==================================================================
   [Section 11] → Headings
   Purpose: Futuristic but subtle heading styles (clean neon)
   ================================================================== */

      /* 🌐 Common base */
      h1,
      h2 {
        text-align: center;
        font-family: "Orbitron", sans-serif;
        color: #00e0e0;
        letter-spacing: 1px;
        margin-bottom: 20px;
        text-shadow: 0 0 2px #00e0e0, 0 0 4px rgba(0, 255, 255, 0.4);
      }

      /* 🔷 h1 - Section Title */
      h1 {
        font-size: 2.2rem;
        font-weight: 600;
      }

      /* 🔹 h2 - Subsection Title */
      h2 {
        font-size: 1.6rem;
        font-weight: 500;
        color: #66ffff;
        text-shadow: 0 0 1px #66ffff, 0 0 3px rgba(102, 255, 255, 0.3);
      }

      /* 📱 Mobile responsiveness */
      @media (max-width: 480px) {
        h1 {
          font-size: 1.6rem;
        }
        h2 {
          font-size: 1.3rem;
        }
      }

      /* ================================================================== */

      /* ==================================================================
   [Section 12] → Timer Display
   Purpose: Modern, clear and responsive sprint time blocks
   ================================================================== */

      .timer-section {
        margin-bottom: 30px;
      }

      /* 🚀 Time block design */
      .time-block {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 10px;
        padding: 14px 18px;
        margin: 12px 0;
        border-radius: 12px;
        background: linear-gradient(135deg, #222, #2c2c2c);
        border: 1px solid rgba(0, 255, 255, 0.15);
        box-shadow: inset 0 0 4px rgba(0, 255, 255, 0.1),
          0 0 8px rgba(0, 255, 255, 0.1);
        font-size: 1.6rem;
        color: #e0f7fa;
        transition: transform 0.2s ease, box-shadow 0.3s ease;
      }

      /* ✨ On hover – minor lift */
      .time-block:hover {
        transform: scale(1.02);
        box-shadow: inset 0 0 6px rgba(0, 255, 255, 0.2),
          0 0 12px rgba(0, 255, 255, 0.2);
      }

      /* 🧠 Responsive tuning */
      @media (max-width: 480px) {
        .time-block {
          flex-direction: column;
          text-align: center;
          font-size: 1.3rem;
          padding: 12px 14px;
        }
      }

      /* ================================================================== */

      /* ==================================================================
   [Section 13] → Progress Bar
   Purpose: Futuristic gradient + glowing progress indicator
   ================================================================== */

      /* 🔲 Wrapper: Glass effect base track */
      .progress-bar-wrapper {
        width: 100%;
        height: 12px;
        margin-top: 12px;
        background: rgba(51, 51, 51, 0.7);
        border-radius: 30px;
        overflow: hidden;
        box-shadow: inset 0 0 5px rgba(0, 255, 255, 0.1);
        backdrop-filter: blur(4px);
      }

      /* 🚀 Animated Progress Fill */
      .progress-bar {
        height: 100%;
        width: 0%;
        background: linear-gradient(to right, #00ffff, #00ff99);
        transition: width 0.4s ease-in-out;
        animation: progressPulse 2s infinite ease-in-out;
        box-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
        border-radius: 30px;
      }

      /* ✨ Glow Pulse Animation */
      @keyframes progressPulse {
        0% {
          box-shadow: 0 0 6px rgba(0, 255, 255, 0.2);
        }
        50% {
          box-shadow: 0 0 12px rgba(0, 255, 255, 0.4);
        }
        100% {
          box-shadow: 0 0 6px rgba(0, 255, 255, 0.2);
        }
      }

      /* ================================================================== */
      /* ==================================================================
   [Section 14] → Sprint Input Section (Ultra Pro+ Optimized)
   ================================================================== */

      /* 🧱 Layout Flex Wrap */
      .sprint-setup {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 16px;
        margin-bottom: 26px;
        padding: 10px;
      }

      /* ⌨️ Time Inputs with glass blur and glow */
      .sprint-setup input {
        width: 72px;
        padding: 12px;
        font-size: 1.05rem;
        text-align: center;
        border: none;
        border-radius: 10px;
        color: #ffffff;
        background: rgba(0, 255, 255, 0.06);
        backdrop-filter: blur(4px);
        box-shadow: inset 0 0 6px rgba(0, 255, 255, 0.2),
          0 0 4px rgba(0, 255, 255, 0.15);
        transition: 0.3s ease all;
      }

      .sprint-setup input:focus {
        outline: none;
        background-color: rgba(0, 255, 255, 0.1);
        box-shadow: 0 0 10px #00ffff, inset 0 0 10px #00ffff;
        border: 1px solid #00ffff;
      }

      /* 🚀 Sprint Start Button - Gradient + Neon Glow */
      .sprint-setup button {
        padding: 14px 26px;
        font-size: 1rem;
        font-weight: 700;
        border: none;
        border-radius: 12px;
        color: #121212;
        background: linear-gradient(135deg, #00e5ff, #00ffb3);
        box-shadow: 0 0 10px #00ffff99, 0 0 18px #00ffff33;
        cursor: pointer;
        transition: all 0.25s ease;
        text-transform: uppercase;
        letter-spacing: 1px;
        z-index: 1000000;
      }

      .sprint-setup button:hover {
        transform: translateY(-2px) scale(1.05);
        box-shadow: 0 0 20px #00ffff, 0 0 40px #00ffcc66;
        background: linear-gradient(135deg, #00ffff, #00e5ff);
        color: #121212;
      }

      /* ================================================================== */

      /* ==================================================================
   [Section 15] → Controls Section (Ultimate GlowGlass Edition 🚨)
   ================================================================== */

      .controls {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-wrap: wrap;
        gap: 18px;
        margin: 28px 0;
        padding: 12px;
      }

      /* ✨ Button: Glassy Background + Rainbow Glow + Smooth Border */
      .controls button {
        padding: 14px 28px;
        font-size: 1.05rem;
        font-weight: 600;
        border: none;
        border-radius: 14px;
        cursor: pointer;
        background: rgba(20, 20, 20, 0.6);
        backdrop-filter: blur(10px);
        color: #e0ffff;
        border: 1px solid rgba(0, 255, 204, 0.3);
        box-shadow: 0 0 6px rgba(0, 255, 255, 0.3),
          inset 0 0 4px rgba(0, 255, 255, 0.1), 0 0 20px rgba(0, 255, 255, 0.05);
        transition: all 0.3s ease;
        position: relative;
        text-transform: uppercase;
        letter-spacing: 0.8px;
        z-index: 1;
      }

      /* 🧊 Hover Effect: Aqua Glow + Depth Pop */
      .controls button:hover {
        background: rgba(0, 255, 204, 0.15);
        color: #ff69b4; /* Hot Pink */
        transform: translateY(-2px) scale(1.07);
        box-shadow: 0 0 12px #ff69b4, 0 0 24px rgba(255, 105, 180, 0.4),
          0 0 32px rgba(255, 105, 180, 0.1);
      }

      /* ⚡ Active/Selected Button */
      .active-button {
        background: linear-gradient(to right, #00fff0, #00c9ff);
        color: #121212 !important;
        box-shadow: 0 0 18px #00fff0, 0 0 28px rgba(0, 255, 255, 0.5);
        transform: scale(1.1);
        border: none !important;
      }

      .controls button::after {
        content: "";
        position: absolute;
        top: -10px;
        left: -10px;
        width: calc(100% + 20px);
        height: calc(100% + 20px);
        background: radial-gradient(
          circle,
          rgba(0, 255, 255, 0.15) 0%,
          transparent 70%
        );
        opacity: 0;
        transition: opacity 0.3s;
        border-radius: 20px;
        z-index: -1;
      }
      .controls button:hover::after {
        opacity: 1;
      }

      .controls button {
        animation: controlPulse 4s infinite ease-in-out;
      }

      @keyframes controlPulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.03);
        }
      }

      /* ================================================================== */

      /* ================================================================== */
      /* ==================================================================
   [Section 17] → Status Display
   ================================================================== */
      .status-display {
        background: rgba(255, 255, 255, 0.04);
        padding: 16px 20px;
        border-radius: 12px;
        border: 1px solid rgba(0, 255, 255, 0.12);
        box-shadow: 0 0 10px rgba(0, 255, 255, 0.05);
        backdrop-filter: blur(8px);
      }

      .status-display p {
        margin: 10px 0;
        padding: 10px 14px;
        border-radius: 8px;
        font-size: 1rem;
        background-color: rgba(42, 42, 42, 0.9);
        color: #eee;
        font-family: "Inter", sans-serif;
        letter-spacing: 0.5px;
        transition: background 0.3s ease;
      }

      .status-display .status-true {
        color: #00ffae;
        font-weight: bold;
        text-shadow: 0 0 6px #00ffae;
        border-left: 4px solid #00ffae;
      }

      .status-display .status-false {
        color: #ff4d6d;
        font-weight: bold;
        text-shadow: 0 0 6px #ff4d6d;
        border-left: 4px solid #ff4d6d;
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 18] → Log Section
   ================================================================== */
      .log-section {
        margin-top: 30px;
        background: rgba(0, 255, 255, 0.03);
        padding: 16px;
        border-radius: 12px;
        border: 1px solid rgba(0, 255, 255, 0.1);
        box-shadow: 0 0 10px rgba(0, 255, 255, 0.04);
        backdrop-filter: blur(8px);
      }

      #log-list {
        list-style: none;
        padding: 0;
        margin-top: 12px;
        max-height: 300px;
        overflow-y: auto;
        scrollbar-width: thin;
      }

      #log-list li {
        display: flex;
        justify-content: space-between;
        padding: 10px 14px;
        margin-bottom: 8px;
        background-color: rgba(37, 37, 37, 0.95);
        border-left: 4px solid #00ffff;
        border-radius: 8px;
        font-size: 1rem;
        color: #e0e0e0;
        font-family: "Inter", sans-serif;
        letter-spacing: 0.4px;
        transition: background 0.3s ease, transform 0.2s ease;
      }

      #log-list li:hover {
        background-color: #2e2e2e;
        transform: scale(1.01);
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 19] → Analytics Section
   ================================================================== */
      .analytics {
        margin-top: 30px;
      }
      .analytics h2 {
        color: #00ffff;
        text-align: center;
        margin-bottom: 10px;
      }
      #analytics-list {
        list-style: none;
        padding: 0;
        margin: 0 auto;
        max-width: 400px;
      }
      #analytics-list li {
        display: flex;
        justify-content: space-between;
        padding: 8px 10px;
        background-color: #2a2a2a;
        border-radius: 6px;
        margin-bottom: 5px;
        font-size: 0.95rem;
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 20] → Popup Notes
   ================================================================== */
      .popup.hidden {
        display: none;
      }

      .popup {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(30, 30, 30, 0.95);
        padding: 25px 22px;
        border-radius: 16px;
        box-shadow: 0 0 25px #00ffff, 0 0 10px #00ffff inset;
        z-index: 10000;
        width: 90%;
        max-width: 420px;
        text-align: center;
        animation: fadeIn 0.5s ease-in-out;
        border: 1px solid rgba(0, 255, 255, 0.15);
        backdrop-filter: blur(8px);
      }

      .popup textarea {
        width: 100%;
        height: 120px;
        padding: 12px;
        background: #1e1e1e;
        border: 1px solid rgba(0, 255, 255, 0.1);
        border-radius: 10px;
        color: #ffffff;
        font-size: 1rem;
        font-family: "Inter", sans-serif;
        resize: none;
        box-shadow: 0 0 8px rgba(0, 255, 255, 0.15);
      }

      .popup textarea:focus {
        border: 1px solid #00ffff;
        box-shadow: 0 0 12px #00ffff;
        outline: none;
      }

      .popup button {
        padding: 10px 20px;
        margin-top: 12px;
        border: none;
        border-radius: 10px;
        background: linear-gradient(to right, #00ffff, #00bcd4);
        color: #121212;
        font-weight: bold;
        cursor: pointer;
        font-size: 1rem;
        box-shadow: 0 0 8px #00ffff;
        transition: all 0.3s ease;
      }

      .popup button:hover {
        background: linear-gradient(to right, #ff66cc, #ff99ff);
        color: #ffffff;
        box-shadow: 0 0 15px #ff66cc, 0 0 25px #ff99ff;
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 21] → Title Input Section
   ================================================================== */
      .title-setup {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 12px;
        margin: 24px 0;
        flex-wrap: wrap;
        padding: 0 10px;
      }

      .title-setup input {
        padding: 12px 16px;
        width: clamp(200px, 30%, 320px);
        font-size: 1rem;
        border: none;
        border-radius: 10px;
        background-color: #1e1e1e;
        color: #ffffff;
        box-shadow: 0 0 6px rgba(0, 255, 255, 0.3);
        transition: all 0.3s ease;
        border: 1px solid rgba(0, 255, 255, 0.15);
      }

      .title-setup input::placeholder {
        color: #888;
        font-style: italic;
      }

      .title-setup input:focus {
        outline: none;
        border: 1px solid #00ffff;
        box-shadow: 0 0 12px #00ffff;
      }

      .title-setup button {
        padding: 12px 20px;
        border: none;
        border-radius: 10px;
        background: linear-gradient(to right, #00ffff, #00bcd4);
        color: #121212;
        font-weight: 600;
        font-size: 1rem;
        cursor: pointer;
        box-shadow: 0 0 10px #00ffff;
        transition: all 0.3s ease;
      }

      .title-setup button:hover {
        background: linear-gradient(to right, #ff66cc, #ff99ff);
        color: #ffffff;
        transform: scale(1.06);
        box-shadow: 0 0 15px #ff66cc, 0 0 25px #ff99ff;
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 22] → Responsive Layout
   ================================================================== */
      @media (max-width: 768px) {
        .container {
          max-width: 92vw;
          padding: 20px;
        }

        .controls,
        .sprint-setup,
        .title-setup {
          flex-direction: column;
          align-items: stretch;
        }

        .sprint-setup input,
        .sprint-setup button,
        .title-setup input,
        .title-setup button,
        .controls button {
          width: 100%;
          font-size: 1rem;
          padding: 12px;
        }
      }

      @media (max-width: 480px) {
        h1,
        h2 {
          font-size: 1.4rem;
        }

        #fullscreen-overlay h1 {
          font-size: 1rem;
        }

        #fullscreen-timer {
          font-size: 2.2rem;
        }

        .time-block {
          font-size: 1.1rem;
          flex-direction: column;
          text-align: center;
          padding: 8px;
        }

        .popup textarea {
          height: 70px;
        }

        #fullscreen-btn {
          padding: 8px 10px;
          font-size: 0.85rem;
        }

        #running-message {
          font-size: 1.1rem;
          margin-bottom: 8px;
        }

        .progress-bar-wrapper {
          height: 8px;
        }

        .controls button {
          font-size: 0.95rem;
        }
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 23] → Running Motivational Message
   ================================================================== */
      #running-message {
        font-size: 1.8rem;
        color: #ff69b4; /* Soft neon pink for fresh look */
        margin-bottom: 20px;
        text-align: center;
        display: none;
        font-family: "Orbitron", sans-serif;
        text-shadow: 0 0 5px #ff69b4, 0 0 10px #ff69b4, 0 0 15px #ff1493;
        animation: pulseRunning 2s infinite;
        letter-spacing: 1px;
        user-select: none;
        line-height: 1.4;
        max-width: 90vw;
        margin-left: auto;
        margin-right: auto;
      }

      @media (max-width: 480px) {
        #running-message {
          font-size: 1.2rem;
          margin-bottom: 12px;
        }
      }
      /* ================================================================== */

      /* ==================================================================
   
/* ==================================================================
 /* ==================================================================
/* ==================================================================
  /* [Section 24] → Sprint Toast
   ================================================================== */
      #sprint-toast {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: rgba(20, 20, 20, 0.85); /* frosted dark */
        backdrop-filter: blur(12px);
        color: #f2f2f2;
        padding: 14px;
        border-radius: 12px;
        font-size: 0.9rem;
        font-weight: 600;
        z-index: -1; /* Initially behind other elements */
        box-shadow: inset 0 0 8px rgba(0, 255, 255, 0.08),
          0 0 18px rgba(0, 255, 255, 0.25);
        opacity: 0;
        visibility: hidden; /* Hide toast initially */
        flex-direction: column;
        max-width: 95vw;
        width: 430px;
        max-height: 250px;
        overflow: hidden;
        text-align: left;
        text-shadow: 0 0 2px #000;
        line-height: 1.5;
        word-wrap: break-word;
        white-space: normal;
        transform: scale(0.96);
        border: 1px solid rgba(0, 255, 255, 0.15);
        pointer-events: none; /* Disable interaction when hidden */
      }

      #sprint-toast.show {
        opacity: 1;
        visibility: visible; /* Make the toast visible when it's shown */
        bottom: 30px;
        transform: scale(1);
        z-index: 9999; /* Bring to front when visible */
        pointer-events: auto; /* Enable interaction when visible */
        display: flex; /* Display as flex when shown */
        transition: opacity 0.4s ease, bottom 0.4s ease, transform 0.4s ease;
      }

      /* ✅ Sticky Close Button */
      #sprint-toast-close {
        position: absolute;
        top: 6px;
        right: 10px;
        background: transparent;
        border: none;
        color: #ccc;
        font-size: 1.3rem;
        cursor: pointer;
        font-weight: bold;
        z-index: 10001;
        transition: color 0.3s ease;
      }

      #sprint-toast-close:hover {
        color: #ff69b4;
        text-shadow: 0 0 6px #ff69b4;
      }

      /* ✅ Scrollable Toast Message */
      #sprint-toast-message {
        margin-top: 28px;
        overflow-y: auto;
        max-height: 190px;
        padding-right: 6px;
        white-space: normal;
        font-size: 0.9rem;
        line-height: 1.5;
      }

      /* ✅ Webkit Scrollbar */
      #sprint-toast-message::-webkit-scrollbar {
        width: 6px;
      }
      #sprint-toast-message::-webkit-scrollbar-thumb {
        background-color: #00cccc;
        border-radius: 4px;
      }

      /* ✅ Mobile Responsive */
      @media (max-width: 600px) {
        #sprint-toast {
          bottom: 12px;
          left: 50%;
          right: auto;
          transform: translateX(-50%) scale(0.96);
          width: 94%;
          max-height: 37vh;
          padding: 14px 12px;
          font-size: 0.75rem;
          display: flex;
          flex-direction: column;
          overflow: hidden; /* Prevent full screen overflow */
          pointer-events: none; /* Disable interaction when not visible */
        }

        #sprint-toast.show {
          bottom: 12px;
          transform: translateX(-50%) scale(1);
          pointer-events: auto; /* Enable interaction when visible */
        }

        #sprint-toast-message {
          flex: 1;
          overflow-y: auto;
          max-height: 100%;
          font-size: 0.75rem;
          line-height: 1.45;
          padding-right: 4px;
          pointer-events: auto; /* Ensure scrolling works */
        }

        #sprint-toast-close {
          font-size: 1.1rem;
          pointer-events: auto;
          top: 4px;
          right: 8px;
        }
      }

      /* 🌟 Toast Inner Styling Classes */
      .toast-title {
        color: #ffffff;
        font-size: 1.05rem;
        font-weight: 700;
        text-shadow: 0 0 6px #ffffffaa, 0 0 12px #00ffff;
        margin-bottom: 6px;
      }

      .toast-label {
        color: #ffa500;
        font-weight: 600;
        text-shadow: 0 0 5px rgba(255, 165, 0, 0.4);
      }

      .toast-time {
        color: #00eaff;
        font-weight: 500;
        text-shadow: 0 0 5px #00ffff66;
      }

      .toast-break {
        color: #ff66cc;
        font-weight: 500;
        text-shadow: 0 0 6px #ff66ccaa;
      }

      .toast-focus {
        color: #ffd700;
        font-weight: 700;
        letter-spacing: 1px;
        text-shadow: 0 0 6px #ffd700aa;
        font-family: "Orbitron", sans-serif;
        margin-top: 4px;
      }

      .toast-success {
        color: #39ff14;
        font-weight: bold;
        text-shadow: 0 0 5px #39ff1488;
        font-family: "Orbitron", sans-serif;
        margin-top: 6px;
      }

      /* ================================================================== */

      /* ================================================================== */

      /* ==================================================================
   [Section 25] → 🕘 Sprint History Section (Neon Glass UI)
   ================================================================== */
      .sprint-history {
        margin-top: 40px;
        padding: 24px 28px;
        background: rgba(0, 255, 255, 0.05);
        border-radius: 20px;
        box-shadow: 0 0 25px rgba(0, 255, 255, 0.15),
          0 8px 30px rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(14px);
        border: 1px solid rgba(0, 255, 255, 0.2);
        color: #e0f7fa;
        font-family: "Segoe UI", sans-serif;
        animation: fadeIn 0.6s ease-in-out;
        transition: all 0.4s ease;
      }

      .sprint-history:hover {
        box-shadow: 0 0 40px rgba(0, 255, 255, 0.3),
          0 12px 35px rgba(0, 0, 0, 0.6);
        transform: translateY(-4px);
      }

      .sprint-history h2 {
        margin-bottom: 18px;
        font-size: 1.8rem;
        color: #00ffff;
        text-shadow: 0 0 8px #00e5ff, 0 0 15px rgba(0, 255, 255, 0.3);
        border-bottom: 1px solid rgba(0, 255, 255, 0.2);
        padding-bottom: 6px;
        font-family: "Orbitron", sans-serif;
        letter-spacing: 1px;
      }

      @media (max-width: 480px) {
        .sprint-history {
          padding: 18px;
        }
        .sprint-history h2 {
          font-size: 1.5rem;
        }
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 25.1] → Scrollable List Container (Enhanced Neon Style)
   ================================================================== */
      #sprint-history-list {
        list-style: none;
        padding: 0;
        margin: 0;
        max-height: 320px;
        overflow-y: auto;
        scrollbar-width: thin;
        scrollbar-color: #00ffff #1e1e1e;
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.02);
        box-shadow: inset 0 0 8px rgba(0, 255, 255, 0.08);
        padding-right: 8px;
      }

      #sprint-history-list::-webkit-scrollbar {
        width: 8px;
      }

      #sprint-history-list::-webkit-scrollbar-track {
        background: #1e1e1e;
        border-radius: 10px;
      }

      #sprint-history-list::-webkit-scrollbar-thumb {
        background: #00ffff;
        border-radius: 10px;
        box-shadow: inset 0 0 5px #00ffff;
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 25.2] → 🔷 Date Headers (Enhanced Neon Tab)
   ================================================================== */
      #sprint-history-list .date-header {
        background: linear-gradient(
          90deg,
          rgba(0, 229, 255, 0.08),
          rgba(0, 229, 255, 0)
        );
        border-left: 5px solid #00e5ff;
        padding: 10px 16px;
        border-radius: 10px;
        margin: 20px 0 12px;
        font-weight: 700;
        color: #00e5ff;
        text-shadow: 0 0 6px rgba(0, 229, 255, 0.5);
        font-size: 1.1rem;
        box-shadow: inset 0 0 8px rgba(0, 229, 255, 0.1),
          0 0 8px rgba(0, 229, 255, 0.1);
        letter-spacing: 0.5px;
        backdrop-filter: blur(2px);
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 25.3] → 🧊 Sprint/Timer Entries (Frosted Neon Card)
   ================================================================== */
      #sprint-history-list li {
        background: linear-gradient(
          135deg,
          rgba(0, 229, 255, 0.03),
          rgba(255, 255, 255, 0.02)
        );
        padding: 16px 20px;
        border-radius: 14px;
        margin-bottom: 12px;
        border: 1px solid rgba(0, 229, 255, 0.12);
        color: #e0f7fa;
        backdrop-filter: blur(6px);
        box-shadow: inset 0 0 4px rgba(0, 229, 255, 0.05),
          0 0 8px rgba(0, 229, 255, 0.08);
        transition: transform 0.3s ease, box-shadow 0.3s ease,
          background 0.3s ease;
        position: relative;
        font-size: 0.98rem;
        letter-spacing: 0.3px;
        font-family: "Segoe UI", sans-serif;
      }

      #sprint-history-list li:hover {
        transform: translateY(-3px) scale(1.02);
        background: rgba(0, 229, 255, 0.06);
        box-shadow: 0 0 14px rgba(0, 229, 255, 0.3),
          0 0 4px rgba(0, 229, 255, 0.15);
        border-color: #00e5ff66;
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 25.4] → Sprint Entry Text (Enhanced Glow Typography)
   ================================================================== */
      #sprint-history-list li span {
        display: block;
        margin-bottom: 5px;
        line-height: 1.5;
        font-size: 0.97rem;
        color: #e0ffff;
        text-shadow: 0 0 3px rgba(0, 255, 255, 0.15);
        letter-spacing: 0.3px;
        font-weight: 500;
        word-break: break-word;
        transition: color 0.3s ease;
      }

      #sprint-history-list li:hover span {
        color: #ffffff;
        text-shadow: 0 0 5px rgba(0, 229, 255, 0.3);
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 25.5] → 🔺 Color Highlights (Sprint/Timer)
   ================================================================== */
      #sprint-history-list li span:first-child {
        font-weight: 600;
        font-size: 1rem;
        color: #ffffff;
        text-shadow: 0 0 4px rgba(255, 255, 255, 0.1);
      }

      /* Sprint entries */
      #sprint-history-list li .sprint {
        color: #7df9ff;
        font-weight: bold;
        text-shadow: 0 0 5px rgba(125, 249, 255, 0.3);
      }

      /* Timer entries */
      #sprint-history-list li .timer {
        color: #ffb347;
        font-weight: bold;
        text-shadow: 0 0 5px rgba(255, 179, 71, 0.3);
      }
      /* ================================================================== */

      /* ==================================================================
   [Section 25.6] → 🌀 Custom Scrollbar (Vertical Only)
   ================================================================== */
      #sprint-history-list {
        overflow-y: auto;
        overflow-x: hidden; /* 👈 disables horizontal scrollbar */
      }

      #sprint-history-list::-webkit-scrollbar {
        width: 8px;
      }

      #sprint-history-list::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, #00e5ff, #7df9ff);
        border-radius: 12px;
        box-shadow: 0 0 6px rgba(0, 229, 255, 0.4);
        transition: background 0.3s ease;
      }

      #sprint-history-list::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, #00ffff, #00bcd4);
        box-shadow: 0 0 10px rgba(0, 255, 255, 0.6);
      }

      #sprint-history-list::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.03);
        border-radius: 12px;
      }
      /* ================================================================== */
      @media (max-width: 480px) {
        .container {
          padding-top: 43px; /* Button se neeche dikhane ke liye space */
        }
      }

      #completion-message {
        position: absolute;
        bottom: 10%;
        width: 100%;
        text-align: center;
        font-size: 1.5rem;
        color: #00ff00; /* green for positive vibe */
        display: none;
      }

      /* === [Fullscreen Scroll Lock] === */
      :fullscreen,
      :-webkit-full-screen,
      :-moz-full-screen,
      :-ms-fullscreen {
        overflow: hidden !important;
        height: 100vh !important;
      }

      body:fullscreen,
      html:fullscreen {
        overflow: hidden !important;
        height: 100vh !important;
      }

      body.fullscreen-mode,
      html.fullscreen-mode {
        overflow: hidden !important;
        height: 100vh !important;
      }

      /* ==================================================================
  /* [Section 26] → Fullscreen Clock
   ================================================================== */

      /* [Section 26] → Fullscreen Clock - Final Premium Design
   ================================================================== */

      #fullscreen-clock {
        position: absolute;
        bottom: 16px;
        right: 20px;
        font-size: 15px;
        font-weight: 600;
        font-family: "JetBrains Mono", "Courier New", monospace;
        color: #ffffffee; /* soft white with slight glow */
        padding: 8px 14px;
        border-radius: 14px;
        background: rgba(255, 255, 255, 0.05); /* ultra-thin glass effect */
        backdrop-filter: blur(8px) saturate(180%);
        -webkit-backdrop-filter: blur(8px) saturate(180%);
        border: 1px solid rgba(255, 255, 255, 0.15);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3),
          inset 0 0 10px rgba(255, 255, 255, 0.05);
        z-index: 9999;
        transition: all 0.4s ease;
        display: none;
        letter-spacing: 0.5px;
      }

      /* ✅ Show clock only in fullscreen */
      #fullscreen-overlay.show #fullscreen-clock {
        display: block;
        animation: slideFadeIn 0.6s ease-out forwards;
      }

      /* ✅ Slide & Fade Animation */
      @keyframes slideFadeIn {
        0% {
          opacity: 0;
          transform: translateY(20px) scale(0.95);
        }
        100% {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      /* ✅ Mobile Friendly Tweak */
      @media (max-width: 600px) {
        #fullscreen-clock {
          font-size: 13px;
          padding: 6px 10px;
          bottom: 12px;
          right: 14px;
          border-radius: 10px;
        }
      }

      /* ==================================================================
   [Section 27] → copy log button
   ================================================================== */
     .copy-log-btn {
  position: absolute;
  bottom: 12px;
  right: 12px;
  background-color: #1f1f1f;
  border: 1px solid #444;
  color: #fff;
  border-radius: 50%;
  cursor: pointer;
  font-size: 16px;
  width: 38px;
  height: 38px;
  text-align: center;
  line-height: 38px;
  padding: 0;
  transition: background-color 0.3s ease, transform 0.2s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  z-index: 99;
}

.copy-log-btn:hover {
  background-color: #333;
  transform: scale(1.1);
}

/* ✅ Mobile-Friendly */
@media (max-width: 768px) {
  .copy-log-btn {
    width: 34px;
    height: 34px;
    font-size: 14px;
    line-height: 34px;
    bottom: 10px;
    right: 10px;
  }
}

    </style>

    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Fullscreen Button -->
    <button id="fullscreen-btn">⛶ Full Screen</button>

    <!-- App Container -->
    <div class="container">
      <!-- App Title -->
      <h1>⏱ RN Study Sprint</h1>

      <!-- Custom Title Input -->
      <div class="title-setup">
        <input
          type="text"
          id="custom-title-input"
          placeholder="Enter your Sprint Title"
        />
        <button id="save-title-btn">Save Title</button>
      </div>

      <!-- Timer Display -->
      <div class="timer-section">
        <div id="elapsed-time" class="time-block">
          <label>🔁 Time Spent</label>
          <span>00:00:00</span>
        </div>
        <div id="remaining-time" class="time-block">
          <label> ⌛ Time Left</label>
          <span>00:00:00</span>
        </div>
        <div class="progress-bar-wrapper">
          <div id="progress-bar" class="progress-bar"></div>
        </div>
      </div>

      <!-- Sprint Goal -->
      <div class="sprint-setup">
        <h2>🎯 Set Sprint Goal</h2>
        <input type="number" id="hours" placeholder="HH" min="0" />
        <input type="number" id="minutes" placeholder="MM" min="0" max="59" />
        <input type="number" id="seconds" placeholder="SS" min="0" max="59" />
        <button id="set-sprint">Set Sprint</button>
      </div>

      <!-- Controls -->
      <div class="controls">
        <button id="start-btn">▶️ Start</button>
        <button id="pause-btn">⏸ Pause</button>
        <button id="reset-btn">🔄 Reset</button>
        <!-- 💾 Timer Mode Save Button -->
        <button id="save-timer-session-btn" class="hidden">
          💾 Save Timer Session
        </button>
      </div>

      <!-- 📅 Daily Log (renamed from Sprint History) -->
      <div class="sprint-history">
        <h2>📅 Daily Log</h2>
        <ul id="sprint-history-list"></ul>
      </div>
    </div>

    <!-- Session Notes Popup -->
    <div id="notes-popup" class="popup hidden">
      <h2>📝 Sprint Notes</h2>
      <textarea id="notes-text" placeholder="What did you study?"></textarea>
      <button id="save-note-btn">Save Note</button>
    </div>

    <!-- Fullscreen Overlay Display -->
    <div id="fullscreen-overlay" class="hidden">
      <div id="fullscreen-controls" class="hidden">
        <button id="fs-toggle-btn">▶️</button>
        <button id="music-toggle-btn">🎵</button>
        <audio id="study-music" src="got_rn.mp3" preload="auto" loop></audio>
        <audio id="start-sound" src="start_timer.mp3" preload="auto"></audio>
        <audio id="end-sound" src="end_timer.mp3" preload="auto"></audio>

        <!-- ✅ NEW LOG BUTTON -->
        <button id="log-toggle-btn" class="fullscreen-btn hidden">📋</button>
      </div>

      <!-- ✅ Funny pause message -->
      <div id="pause-message" class="hidden">Why stop? I'm crying 😭💀⏱️</div>

      <!-- ✅ Motivational running message -->
      <div id="running-message" class="hidden">
        Keep Pushing 🔥, Hustle in Progress… ⏳😎
      </div>

      <!-- ✅ NEW: Completion message for sprint/timer done -->
      <div id="completion-message" class="hidden">
        🎯 Target hit! 💪 Be proud.🔄 Keep moving. 💪✅
      </div>

      <h1 id="fullscreen-title">📘 Study Sprint</h1>

      <div id="fullscreen-timer">00:00:00</div>

      <!-- ✅ Step 1: New Fullscreen Clock -->
      <div id="fullscreen-clock">--:--:--</div>
    </div>

    <!-- ✅ Toast Message -->
    <div id="sprint-toast">
      <button id="sprint-toast-close">✖</button>
      <div id="sprint-toast-message"></div>
      <!-- <button id="copy-log-btn" class="copy-log-btn">📋 Copy Log</button> -->
    </div>

    <!-- <script src="script.js"></script> -->
    <script>
      // ===================== Part 1: Variable Initialization =====================
      // Initialize global variables related to time, sprint, and UI elements.
      let elapsedSeconds = 0;
      let sprintGoalSeconds = 0;
      let sprintSet = false;
      let sprintCompleted = false; // ✅ NEW
      let timerInterval = null;
      let customTitle = "";
      let lastDate = getISTDate();
      let sprintStartTime = null;
      let sprintEndTime = null;
      let startedAs = "timer";
      let sprintBreaks = [];

      // DOM references for UI elements
      const elapsedTimeDisplay = document.querySelector("#elapsed-time span");
      const remainingTimeDisplay = document.querySelector(
        "#remaining-time span"
      );
      const progressBar = document.getElementById("progress-bar");
      const startBtn = document.getElementById("start-btn");
      const pauseBtn = document.getElementById("pause-btn");
      const resetBtn = document.getElementById("reset-btn");
      const setSprintBtn = document.getElementById("set-sprint");
      const modeStatus = document.getElementById("mode-status");
      const fullscreenBtn = document.getElementById("fullscreen-btn");
      const fullscreenOverlay = document.getElementById("fullscreen-overlay");
      const fullscreenTimer = document.getElementById("fullscreen-timer");
      const titleInput = document.getElementById("custom-title-input");
      const saveTitleBtn = document.getElementById("save-title-btn");
      const fullscreenTitle = document.getElementById("fullscreen-title");
      const pauseMessage = document.getElementById("pause-message");
      const runningMessage = document.getElementById("running-message");
      const sprintToast = document.getElementById("sprint-toast");
      const sprintToastMessage = document.getElementById(
        "sprint-toast-message"
      );
      const sprintToastClose = document.getElementById("sprint-toast-close");
      const fsControls = document.getElementById("fullscreen-controls");
      const fsToggleBtn = document.getElementById("fs-toggle-btn");
      const sprintHistoryList = document.getElementById("sprint-history-list");
      const saveTimerSessionBtn = document.getElementById(
        "save-timer-session-btn"
      );
      const musicToggleBtn = document.getElementById("music-toggle-btn");
      const studyMusic = document.getElementById("study-music");
      const startSound = document.getElementById("start-sound");
      const endSound = document.getElementById("end-sound");

      // ✅ Volume control
      startSound.volume = 0.1;
      endSound.volume = 0.1;

      let fsControlsTimeout = null;
      let isMusicPlaying = false;
      const logToggleBtn = document.getElementById("log-toggle-btn"); // ✅ New Log Button

      // ========== Wake Lock Setup ==========
      // ========== Wake Lock Setup ==========
      let wakeLock = null;

      async function requestWakeLock() {
        try {
          if ("wakeLock" in navigator) {
            wakeLock = await navigator.wakeLock.request("screen");
            console.log("✅ Wake Lock active");

            wakeLock.addEventListener("release", () => {
              console.log("🔓 Wake Lock released");
            });
          }
        } catch (err) {
          console.error("⚠️ Wake Lock error:", err.name, err.message);
        }
      }

      // Try again when tab becomes visible
      document.addEventListener("visibilitychange", () => {
        if (document.visibilityState === "visible") requestWakeLock();
      });

      // ===================== Part 2: Window Event Listeners =====================
      // Load saved data from localStorage when the page loads
      window.addEventListener("DOMContentLoaded", () => {
        loadFromLocal();
        updateDisplay();
        renderSprintHistory();
        setInterval(autoResetDaily, 60 * 1000);

        // ✅ Only set text if modeStatus element exists
        if (typeof modeStatus !== "undefined" && modeStatus)
          modeStatus.textContent = "Current Mode: Focus";

        requestWakeLock();
      });

      // ✅ Step 3: Unlock audio on first click
      window.addEventListener(
        "click",
        () => {
          const startSound = document.getElementById("start-sound");
          const endSound = document.getElementById("end-sound");

          if (startSound && endSound) {
            startSound.muted = true;
            endSound.muted = true;

            // Try playing and pausing to unlock
            startSound
              .play()
              .then(() => {
                startSound.pause();
                startSound.currentTime = 0;
                startSound.muted = false; // ✅ Unmute after unlocking
              })
              .catch((err) => console.log("Start sound unlock error:", err));

            endSound
              .play()
              .then(() => {
                endSound.pause();
                endSound.currentTime = 0;
                endSound.muted = false; // ✅ Unmute after unlocking
              })
              .catch((err) => console.log("End sound unlock error:", err));
          }
        },
        { once: true }
      ); // ✅ Only runs once

      // ===================== Part 3: Timer Functions =====================

      // Start the timer
      function startTimer() {
        if (timerInterval) return;

        // ✅ Play Start Sound
        startSound.currentTime = 0;
        startSound.volume = 0.7;
        startSound.play().catch((err) => {
          console.log("🔇 Start sound error:", err.message);
        });

        if (!sprintStartTime) {
          sprintStartTime = getCurrentTime();
        }

        startedAs = sprintSet ? "sprint" : "timer";
        sprintCompleted = false; // ✅ reset

        // ✅ Close ongoing break if restarting
        if (sprintSet && sprintBreaks.length > 0) {
          const last = sprintBreaks[sprintBreaks.length - 1];
          if (last && !last.end) {
            last.end = getCurrentTime();
            const totalBefore = sprintBreaks
              .slice(0, -1)
              .reduce((s, b) => s + b.duration, 0);
            last.duration = elapsedSeconds - totalBefore;
          }
        }

        timerInterval = setInterval(() => {
          elapsedSeconds++;
          updateDisplay();
          saveToLocal();

          if (
            sprintSet &&
            elapsedSeconds >= sprintGoalSeconds &&
            !sprintCompleted
          ) {
            // ✅ End sound
            endSound.currentTime = 0;
            endSound.volume = 0.1;
            endSound.play().catch((err) => {
              console.log("🔇 End sound error:", err.message);
            });

            sprintCompleted = true;

            // ✅ Close ongoing break at the moment of completion
            if (sprintBreaks.length > 0) {
              const last = sprintBreaks[sprintBreaks.length - 1];
              if (last && !last.end) {
                last.end = getCurrentTime();
                const totalBefore = sprintBreaks
                  .slice(0, -1)
                  .reduce((s, b) => s + b.duration, 0);
                last.duration = elapsedSeconds - totalBefore;
              }
            }

            pauseTimer();
            sprintEndTime = getCurrentTime(); // ✅ Mark end time

            saveSprintHistory();
            renderSprintHistory();
            showSprintToast(
              `✅ Sprint "${
                customTitle || "Untitled"
              }" complete! ⏱️ ${formatTime(sprintGoalSeconds)}`
            );

            if (pauseMessage) {
              pauseMessage.textContent =
                "🎉 Target hit! 🎯 Be proud. 💪 Keep moving. ✨";
              pauseMessage.style.display = "block";
            }
          }
        }, 1000);

        if (pauseMessage) pauseMessage.style.display = "none";
        if (runningMessage && document.fullscreenElement)
          runningMessage.style.display = "block";

        saveTimerSessionBtn.classList.add("hidden");
      }

      // ===================== Part 4: Pause and Reset Functions =====================

      // Pause the timer
      function pauseTimer() {
        clearInterval(timerInterval);
        timerInterval = null;

        if (sprintSet && !sprintCompleted) {
          const now = getCurrentTime();
          const last = sprintBreaks[sprintBreaks.length - 1];
          if (last && !last.end) {
            last.end = now;
            const totalBefore = sprintBreaks
              .slice(0, -1)
              .reduce((s, b) => s + b.duration, 0);
            last.duration = elapsedSeconds - totalBefore;
          }

          // Start a new break
          sprintBreaks.push({ start: now, end: null, duration: 0 });
        }

        saveToLocal();

        if (!sprintSet) saveTimerSessionBtn.classList.remove("hidden");

        if (document.fullscreenElement) {
          if (pauseMessage && !sprintCompleted) {
            pauseMessage.textContent = "Why stop? I'm crying 😭💀⏱️";
            pauseMessage.style.display = "block";
          }
          if (runningMessage) runningMessage.style.display = "none";
        }
      }

      // Reset the timer
      function resetTimer() {
        pauseTimer();
        elapsedSeconds = 0;
        sprintGoalSeconds = 0;
        sprintSet = false;
        sprintCompleted = false; // ✅ reset
        sprintStartTime = null;
        sprintEndTime = null;
        sprintBreaks = [];
        saveTimerSessionBtn.classList.add("hidden");
        saveToLocal();
        updateDisplay();
        renderSprintHistory();
        if (pauseMessage) pauseMessage.style.display = "none"; // ✅ hide on reset
      }

      // ===================== Part 5: Display and Time Formatting Functions =====================

      // Update the display of elapsed and remaining time
      function updateDisplay() {
        elapsedTimeDisplay.textContent = formatTime(elapsedSeconds);
        if (sprintSet) {
          const remaining = Math.max(0, sprintGoalSeconds - elapsedSeconds);
          remainingTimeDisplay.textContent = formatTime(remaining);
          progressBar.style.width = `${calculateProgress()}%`;
          if (fullscreenOverlay.classList.contains("show"))
            fullscreenTimer.textContent = formatTime(remaining);
        } else {
          remainingTimeDisplay.textContent = "00:00:00";
          progressBar.style.width = "0%";
          if (fullscreenOverlay.classList.contains("show"))
            fullscreenTimer.textContent = formatTime(elapsedSeconds);
        }
      }

      // Calculate the progress of the sprint timer
      function calculateProgress() {
        return Math.min(
          100,
          (elapsedSeconds / sprintGoalSeconds) * 100
        ).toFixed(1);
      }

      // Format time in HH:MM:SS format
      function formatTime(sec) {
        const isNegative = sec < 0;
        sec = Math.abs(sec); // ✅ always work with +ve

        const h = String(Math.floor(sec / 3600)).padStart(2, "0");
        const m = String(Math.floor((sec % 3600) / 60)).padStart(2, "0");
        const s = String(sec % 60).padStart(2, "0");

        return `${isNegative ? "-" : ""}${h}:${m}:${s}`;
      }

      // ===================== Part 6: Helper Functions =====================

      // Calculate total break time
      function totalBreakSeconds() {
        return sprintBreaks.reduce((sum, b) => {
          if (b.start && b.end && b.duration && b.duration > 0) {
            return sum + b.duration;
          }
          return sum;
        }, 0);
      }

      // Get current date in IST format
      function getISTDate() {
        return new Date().toLocaleDateString("en-GB", {
          timeZone: "Asia/Kolkata",
        });
      }

      // Get current time in IST format
      function getCurrentTime() {
        return new Date().toLocaleTimeString("en-IN", {
          hour: "2-digit",
          minute: "2-digit",
          second: "2-digit",
          hour12: true,
          timeZone: "Asia/Kolkata",
        });
      }

      // ===================== Part 7: Sprint History Functions =====================

      // Save sprint history to localStorage
      function saveSprintHistory() {
        const history = JSON.parse(
          localStorage.getItem("sprint_history") || "[]"
        );
        history.push({
          title: customTitle || "Untitled",
          duration: formatTime(sprintGoalSeconds || elapsedSeconds),
          startTime: sprintStartTime || "Unknown",
          endTime: sprintEndTime || getCurrentTime(),
          date: getISTDate(),
          type: startedAs,
        });
        localStorage.setItem("sprint_history", JSON.stringify(history));
      }

      // Render sprint history from localStorage
      function renderSprintHistory() {
        if (!sprintHistoryList) return;
        sprintHistoryList.innerHTML = "";
        const history = JSON.parse(
          localStorage.getItem("sprint_history") || "[]"
        );
        const grouped = {};
        history.reverse().forEach((entry) => {
          if (!grouped[entry.date]) grouped[entry.date] = [];
          grouped[entry.date].push(entry);
        });
        for (let date in grouped) {
          const dateHeader = document.createElement("li");
          dateHeader.classList.add("date-header");
          date;

          dateHeader.innerHTML = `📅 ${date}`;
          sprintHistoryList.appendChild(dateHeader);
          grouped[date].forEach((entry, index, arr) => {
            const li = document.createElement("li");
            const displayIndex = arr.length - index;
            li.innerHTML = `<span>📌 ${displayIndex}. ${entry.title} (${entry.type})</span><span>⏱️ ${entry.duration} | ${entry.startTime} → ${entry.endTime}</span>`;
            sprintHistoryList.appendChild(li);
          });
        }
      }

      // ===================== Part 8: Auto Reset and Save Functions =====================

      // Automatically reset data at the start of a new day
      function autoResetDaily() {
        const today = getISTDate();
        if (today !== lastDate) {
          elapsedSeconds = 0;
          lastDate = today;
          saveToLocal();
          renderSprintHistory();
          updateDisplay();
        }
      }

      // Save current session data to localStorage
      function saveToLocal() {
        localStorage.setItem(
          "study_data",
          JSON.stringify({
            elapsedSeconds,
            sprintGoalSeconds,
            sprintSet,
            date: getISTDate(),
            customTitle,
            sprintStartTime, // ✅ add this
            sprintEndTime, // ✅ Add this
            sprintBreaks, // ✅ NEW ADD THIS LINE
          })
        );
      }

      // Load saved session data from localStorage
      function loadFromLocal() {
        const saved = JSON.parse(localStorage.getItem("study_data") || "{}");
        if (saved.date === getISTDate()) {
          elapsedSeconds = saved.elapsedSeconds || 0;
          sprintGoalSeconds = saved.sprintGoalSeconds || 0;
          sprintSet = saved.sprintSet || false;
          customTitle = saved.customTitle || "";
          sprintStartTime = saved.sprintStartTime || null; // ✅ add this
          sprintEndTime = saved.sprintEndTime || null; // ✅ Add this
          sprintBreaks = saved.sprintBreaks || []; // ✅ NEW LINE

          titleInput.value = customTitle;
          fullscreenTitle.textContent = customTitle || "Study Sprint";
        }
      }

      // ===================== Part 9: Button Flashing Function =====================

      // Flash button when clicked
      function flashButton(button) {
        button.classList.add("active-button");
        setTimeout(() => button.classList.remove("active-button"), 500);
      }

      // ===================== Part 10: Event Listeners for Buttons =====================

      // Start button click event
      startBtn.addEventListener("click", () => {
        flashButton(startBtn);
        startTimer();
      });

      // Pause button click event
      pauseBtn.addEventListener("click", () => {
        flashButton(pauseBtn);
        pauseTimer();
      });

      // Reset button click event
      resetBtn.addEventListener("click", () => {
        flashButton(resetBtn);
        resetTimer();
      });

      // Set sprint button click event
      setSprintBtn.addEventListener("click", () => {
        flashButton(setSprintBtn);
        sprintBreaks = []; // ✅ Reset breaks for new sprint

        const h = parseInt(document.getElementById("hours").value) || 0;
        const m = parseInt(document.getElementById("minutes").value) || 0;
        const s = parseInt(document.getElementById("seconds").value) || 0;
        const total = h * 3600 + m * 60 + s;
        if (total <= 0) return alert("❌ Invalid Sprint Time.");
        sprintGoalSeconds = total;
        sprintSet = true;
        elapsedSeconds = 0;
        sprintStartTime = null;
        sprintCompleted = false;
        updateDisplay();
        saveToLocal();
      });

      // Save title button click event
      saveTitleBtn.addEventListener("click", () => {
        const title = titleInput.value.trim();
        if (!title) return alert("❌ Enter a title.");
        customTitle = title;
        fullscreenTitle.textContent = title;
        saveToLocal();
        flashButton(saveTitleBtn);
      });

      // Save session button click event
      saveTimerSessionBtn.addEventListener("click", () => {
        // ✅ Fix for Bug 2:
        if (!timerInterval) {
          sprintEndTime = getCurrentTime(); // Timer paused → safe to record end time
        } else {
          sprintEndTime = null; // Timer running → don't assign fake end time
        }

        saveSprintHistory(); // Will now use sprintEndTime only if it's valid
        renderSprintHistory();
        showSprintToast("💾 Timer session saved!");
        saveTimerSessionBtn.classList.add("hidden");
      });

      logToggleBtn.addEventListener("click", () => {
        flashButton(logToggleBtn);

        // ✅ Toggle toast logic
        if (sprintToast.classList.contains("show")) {
          sprintToast.classList.remove("show");
        } else {
          showSprintToast(
            `✅ Sprint "${customTitle || "Untitled"}" complete! ⏱️ ${formatTime(
              sprintSet ? sprintGoalSeconds : elapsedSeconds
            )}`
          );
        }
      });

      // ===================== Toast Close Button Functionality =====================
      /// Function to show the toast after the timer completes
      function showToast() {
        const sprintToast = document.getElementById("sprint-toast");

        // Reset the display style before showing the toast again
        sprintToast.style.display = "flex"; // Show the toast (flex)

        // Add the "show" class to trigger the animation
        sprintToast.classList.add("show");

        // Disable buttons or other elements if needed
        const buttons = [
          startBtn,
          pauseBtn,
          resetBtn,
          setSprintBtn,
          saveTitleBtn,
          saveTimerSessionBtn,
        ];
        buttons.forEach((button) => {
          button.style.pointerEvents = "none"; // Disable buttons during toast visibility
        });
      }

      // Timer complete function to show the toast every time
      function timerComplete() {
        const sprintToast = document.getElementById("sprint-toast");

        // Ensure it's hidden first before showing again
        sprintToast.style.visibility = "hidden"; // Initially hide the toast before showing it again
        sprintToast.style.opacity = "0"; // Initially invisible

        // Call showToast() to display the toast after timer completion
        showToast(); // Show the toast when the timer completes
      }

      // ===================== Part 11: Fullscreen Functionality =====================

      // Fullscreen button click event
      fullscreenBtn.addEventListener("click", () => {
        if (!document.fullscreenElement) {
          document.documentElement.requestFullscreen().then(() => {
            fullscreenOverlay.classList.add("show");
            fullscreenBtn.textContent = "❌ Exit Fullscreen";
            fullscreenTimer.textContent = sprintSet
              ? formatTime(Math.max(0, sprintGoalSeconds - elapsedSeconds))
              : formatTime(elapsedSeconds);
            fullscreenTitle.textContent = customTitle || "Study Sprint";
            if (timerInterval && runningMessage)
              runningMessage.style.display = "block";
            showAndHideFullscreenControls();
          });
        } else {
          document.exitFullscreen().then(() => {
            fullscreenOverlay.classList.remove("show");
            fullscreenBtn.textContent = "⛶ Full Screen";
            fullscreenBtn.classList.remove("hidden");
            fsControls.classList.remove("hidden");
            if (pauseMessage) pauseMessage.style.display = "none";
            if (runningMessage) runningMessage.style.display = "none";
          });
        }
      });

      // Toggle fullscreen controls
      fsToggleBtn.addEventListener("click", () => {
        if (timerInterval) {
          pauseTimer();
          fsToggleBtn.textContent = "▶️";
        } else {
          startTimer();
          fsToggleBtn.textContent = "⏸";
        }
      });

      // Show and hide fullscreen controls after timeout
      function showAndHideFullscreenControls() {
        fullscreenBtn.classList.remove("hidden");
        fsControls.classList.remove("hidden");
        if (fsControlsTimeout) clearTimeout(fsControlsTimeout);
        fsControlsTimeout = setTimeout(() => {
          if (document.fullscreenElement) {
            fullscreenBtn.classList.add("hidden");
            fsControls.classList.add("hidden");
          }
        }, 3000);
      }

      // Event listeners to show/hide fullscreen controls on user interaction
      document.addEventListener("mousemove", showAndHideFullscreenControls);
      document.addEventListener("touchstart", showAndHideFullscreenControls);

      // ===================== Part 12: Sprint Toast Function =====================

      // Show sprint completion toast with detailed information
      function showSprintToast(message) {
        if (!sprintToast || !sprintToastMessage) return;

        if (message.startsWith("✅ Sprint")) {
          const total = sprintGoalSeconds || elapsedSeconds;

          // ✅ Break Time
          let breakSeconds = 0;
          sprintBreaks.forEach((b) => {
            if (b.start && b.end) {
              const start = new Date(`${getISTDate()} ${b.start}`);
              const end = new Date(`${getISTDate()} ${b.end}`);
              const diff = Math.round((end - start) / 1000);
              breakSeconds += Math.max(0, diff);
            }
          });

          // ✅ Focus Time
          const focusSeconds = total - breakSeconds;
          const focusFormatted = formatTime(focusSeconds);
          const breakFormatted = formatTime(breakSeconds);
          const totalFormatted = formatTime(total);

          // ✅ Productivity
          let focusPercent = (focusSeconds / total) * 100;
          let productivity = "";
          if (focusPercent >= 99.9) productivity = "💯 Beast Mode";
          else if (focusPercent >= 80) productivity = "😎 Solid Focus";
          else if (focusPercent >= 50) productivity = "🔁 Good Try";
          else productivity = "😴 Breaky Break";

          // ✅ Logged Time
          const logTime = new Date()
            .toLocaleTimeString("en-IN", {
              timeZone: "Asia/Kolkata",
              hour: "2-digit",
              minute: "2-digit",
              second: "2-digit",
              hour12: true,
            })
            .replace("am", "AM")
            .replace("pm", "PM");

          // ✅ Break Info (HTML)
          const breakInfoHTML =
            sprintBreaks.length === 0
              ? ""
              : sprintBreaks
                  .map(
                    (b, i) =>
                      `<br><span class="toast-break">${i + 1}\u20E3 Break ${
                        i + 1
                      } — ${b.start} → ${b.end}</span>`
                  )
                  .join("");

          // ✅ Break Info (Plain Text)
          const breakInfoText =
            sprintBreaks.length === 0
              ? "No Breaks"
              : sprintBreaks
                  .map(
                    (b, i) => `${i + 1}⃣ Break ${i + 1}: ${b.start} → ${b.end}`
                  )
                  .join("\n");

          // ✅ Final Plain Text for Clipboard
          const messageText = `✅ Sprint: "${customTitle || "Untitled"}"
⏱️ Duration: ${totalFormatted}
🟢 Start Time: ${sprintStartTime || "--"}
🔴 End Time: ${sprintCompleted && sprintEndTime ? sprintEndTime : "--"}
☕ Breaks Taken: ${sprintBreaks.length}
🧠 Focus Time: ${focusFormatted} | ☕ Break Time: ${breakFormatted}
📊 Productivity: ${productivity}
🧭 Logged at: ${logTime}
${breakInfoText}`;

          // ✅ Final HTML message (with button)
          message = `
      <div class="toast-title">✅ Sprint: "${
        customTitle || "Untitled"
      }"</div><br>
      <div><span class="toast-label">⏱️ Duration:</span> ${totalFormatted}</div><br>
      <div><span class="toast-label">🟢 Start Time:</span> ${
        sprintStartTime || "--"
      }</div>
      <div><span class="toast-label">🔴 End Time:</span> ${
        sprintCompleted && sprintEndTime ? sprintEndTime : "--"
      }</div><br>
      <div><span class="toast-label">☕ Breaks Taken:</span> ${
        sprintBreaks.length
      }</div>
      <div><span class="toast-label">🧠 Focus Time:</span> ${focusFormatted} | <span class="toast-label">☕ Break Time:</span> ${breakFormatted}</div><br>
      <div><span class="toast-label">📊 Productivity:</span> ${productivity}</div><br>
      ${breakInfoHTML}<br>
      <div><span class="toast-label">🧭 Logged at:</span> ${logTime}</div><br><br>
      <button id="copy-log-btn" class="copy-log-btn">📋 Copy Log</button>
    `;

          // ✅ Attach message to DOM
          sprintToastMessage.innerHTML = message;

          // ✅ After toast is shown, attach event listener to copy button
          setTimeout(() => {
            const copyBtn = document.getElementById("copy-log-btn");
            if (copyBtn) {
              copyBtn.addEventListener("click", () => {
                navigator.clipboard.writeText(messageText).then(() => {
                  copyBtn.textContent = "✅ Copied!";
                  setTimeout(() => (copyBtn.textContent = "📋 Copy Log"), 2000);
                });
              });
            }
          }, 0);
        }

        sprintToast.classList.add("show");
        sprintToast.classList.remove("hidden");
      }

      // Close the sprint toast
      sprintToastClose.addEventListener("click", () => {
        sprintToast.classList.remove("show");
      });

      // ===================== Part 13: Music Functionality =====================

      // Toggle study music playback
      musicToggleBtn.addEventListener("click", () => {
        if (!isMusicPlaying) {
          studyMusic
            .play()
            .then(() => {
              musicToggleBtn.textContent = "⏸️";
              isMusicPlaying = true;
            })
            .catch((err) => {
              console.log("Music play error:", err);
              alert("⚠️ Cannot play music. It may be blocked or missing.");
            });
        } else {
          studyMusic.pause();
          musicToggleBtn.textContent = "🎵";
          isMusicPlaying = false;
        }
      });

      // ===================== Part 14: Fullscreen Clock =====================
      // ✅ Live Indian Clock for Fullscreen (with AM/PM)
      function updateFullscreenClock() {
        const clockElem = document.getElementById("fullscreen-clock");
        if (!clockElem) return;

        let now = new Date().toLocaleTimeString("en-IN", {
          timeZone: "Asia/Kolkata",
          hour12: true,
          hour: "2-digit",
          minute: "2-digit",
          second: "2-digit",
        });

        // ✅ Convert am/pm to AM/PM (uppercase)
        now = now.replace("am", "AM").replace("pm", "PM");

        clockElem.textContent = "🕒 " + now;
      }

      setInterval(updateFullscreenClock, 1000);

      // =================================================
      // screen on
      document.addEventListener("visibilitychange", () => {
        if (document.visibilityState === "visible") requestWakeLock();
      });
    </script>
  </body>
</html>
